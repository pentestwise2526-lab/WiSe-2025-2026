ðŸ”¹ Title

Serverâ€‘Side Template Injection in Render Function


ðŸ”¹ Affected Lab and Component

Lab Name: WebSploit Renderâ€‘Reign

Component: Template Rendering Engine

Endpoint: /render (or main input submission endpoint)

Parameter:User input field (template/message parameter)

Container: websploit-render-reign

Port: 5021


ðŸ”¹ Vulnerability Classification

CWE: CWEâ€‘94 â€“ Improper Control of Generation of Code (â€˜Code Injectionâ€™)

OWASP Top 10: A03:2021 â€“ Injection


 ðŸ”¹ CVSS v3.1 Score

Score: 9.0 (Critical)

Vector:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H


 ðŸ”¹ Description

The Renderâ€‘Reign application dynamically renders userâ€‘supplied input within a serverâ€‘side template engine without proper sanitization or sandboxing.

Because the application directly evaluates template expressions provided by users, an attacker can inject template syntax that is executed on the server. This behavior enables attackers to execute arbitrary expressions, access internal objects, and potentially achieve remote code execution depending on the template engine configuration.


ðŸ”¹ Exploitation Steps

1. Open the Renderâ€‘Reign lab in a browser.

2. Locate the input field that renders user content.

3. Enter a template expression:


{{7*7}}


4. Submit the input.

5. Observe that the application returns 49, confirming serverâ€‘side evaluation.


ðŸ”¹ Proof of Concept (PoC)


POST /render HTTP/1.1
Host: localhost:5021
Content-Type: application/x-www-form-urlencoded

input={{7*7}}

Response: 49

ðŸ”¹ Impact

Successful exploitation may allow:

* Execution of arbitrary template expressions
* Access to sensitive server objects and configuration
* Potential remote code execution
* Data exposure and full application compromise


ðŸ”¹ Remediation

* Avoid rendering raw user input as templates
* Treat user input strictly as data, not executable content
* Implement template sandboxing and strict variable binding
* Apply input validation and output encoding
* Conduct security testing for injection vulnerabilities
